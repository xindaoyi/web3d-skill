<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web 3D开发需要掌握的线性代数知识</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            color: #333;
        }
        code {
            background-color: #eee;
            padding: 2px 5px;
            border-radius: 3px;
        }
        pre {
            background-color: #333;
            color: #fff;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .benefit {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
        }
        .challenge {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 20px 0;
        }
        .quote {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            font-style: italic;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .formula {
            text-align: center;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            margin: 20px 0;
            font-family: "Times New Roman", serif;
            font-size: 18px;
        }
        .example-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
        }
        canvas {
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Web 3D开发需要掌握的线性代数知识</h1>
        
        <p>线性代数是3D图形学的数学基础，对于Web 3D开发来说更是不可或缺。掌握这些知识将帮助你更好地理解3D变换、光照计算、相机控制等核心概念。</p>
        
        <div class="quote">
            "在3D图形编程中，矢量和矩阵是基础的数学概念。矢量用于表示空间中的点和方向，而矩阵则用于表示3D空间的变换，包括平移、旋转、缩放等。" - JavaScript实现3D全景图教程
        </div>
        
        <h2>基础概念</h2>
        
        <h3>1. 三维坐标系</h3>
        <div class="benefit">
            <p>在Web 3D中，我们使用三维坐标系来描述物体在空间中的位置。</p>
            <ul>
                <li><strong>X轴</strong>：通常指向右侧</li>
                <li><strong>Y轴</strong>：通常指向上方</li>
                <li><strong>Z轴</strong>：指向观察者的前方（右手坐标系）</li>
            </ul>
            <p>WebGL和Three.js使用右手坐标系，这是3D图形学中的标准坐标系。</p>
        </div>
        
        <h3>2. 向量（Vector）</h3>
        <div class="benefit">
            <p>向量是既有大小又有方向的量，在3D图形学中广泛使用。</p>
            <div class="formula">
                向量表示：v = (x, y, z)
            </div>
            
            <h4>向量的基本运算</h4>
            <ul>
                <li><strong>向量加法</strong>：用于位移和力的合成</li>
                <li><strong>向量减法</strong>：用于计算两点间的向量</li>
                <li><strong>标量乘法</strong>：用于缩放向量</li>
                <li><strong>向量长度（模）</strong>：计算向量的大小</li>
                <li><strong>单位向量</strong>：长度为1的向量，用于表示方向</li>
            </ul>
            
            <pre>// JavaScript中向量的基本运算示例
// 向量加法
function vectorAdd(a, b) {
    return [a[0] + b[0], a[1] + b[1], a[2] + b[2]];
}

// 向量减法
function vectorSubtract(a, b) {
    return [a[0] - b[0], a[1] - b[1], a[2] - b[2]];
}

// 标量乘法
function vectorScale(v, scalar) {
    return [v[0] * scalar, v[1] * scalar, v[2] * scalar];
}

// 向量长度
function vectorLength(v) {
    return Math.sqrt(v[0]*v[0] + v[1]*v[1] + v[2]*v[2]);
}

// 单位向量
function normalizeVector(v) {
    const length = vectorLength(v);
    if (length === 0) return [0, 0, 0];
    return [v[0]/length, v[1]/length, v[2]/length];
}</pre>
        </div>
        
        <h3>3. 点积（Dot Product）</h3>
        <div class="benefit">
            <p>点积是两个向量之间的标量运算，结果是一个标量。</p>
            <div class="formula">
                a · b = |a| |b| cos(θ) = a.x×b.x + a.y×b.y + a.z×b.z
            </div>
            
            <p>点积的应用：</p>
            <ul>
                <li>计算两个向量之间的夹角</li>
                <li>判断两个向量是否垂直（点积为0）</li>
                <li>光照计算中的漫反射强度</li>
                <li>投影计算</li>
            </ul>
            
            <pre>// 点积计算
function dotProduct(a, b) {
    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
}

// 使用点积计算光照强度
function calculateDiffuseIntensity(surfaceNormal, lightDirection) {
    // 标准化向量
    const normal = normalizeVector(surfaceNormal);
    const light = normalizeVector(lightDirection);
    
    // 点积即为光照强度
    return Math.max(0, dotProduct(normal, light));
}</pre>
        </div>
        
        <h3>4. 叉积（Cross Product）</h3>
        <div class="benefit">
            <p>叉积是两个向量之间的向量运算，结果是一个垂直于两个输入向量的新向量。</p>
            <div class="formula">
                a × b = (a.y×b.z - a.z×b.y, a.z×b.x - a.x×b.z, a.x×b.y - a.y×b.x)
            </div>
            
            <p>叉积的应用：</p>
            <ul>
                <li>计算垂直于两个向量的平面法向量</li>
                <li>计算三角形的法向量</li>
                <li>确定物体的朝向</li>
            </ul>
            
            <pre>// 叉积计算
function crossProduct(a, b) {
    return [
        a[1] * b[2] - a[2] * b[1],
        a[2] * b[0] - a[0] * b[2],
        a[0] * b[1] - a[1] * b[0]
    ];
}

// 计算三角形法向量
function calculateTriangleNormal(v1, v2, v3) {
    // 计算两条边向量
    const edge1 = vectorSubtract(v2, v1);
    const edge2 = vectorSubtract(v3, v1);
    
    // 叉积得到法向量
    const normal = crossProduct(edge1, edge2);
    
    // 返回单位法向量
    return normalizeVector(normal);
}</pre>
        </div>
        
        <h2>矩阵（Matrix）</h2>
        
        <h3>1. 矩阵基础</h3>
        <div class="benefit">
            <p>矩阵在3D图形学中用于表示变换，包括平移、旋转、缩放等。</p>
            <p>在WebGL和Three.js中，通常使用4x4矩阵来表示3D变换。</p>
            
            <div class="formula">
                4x4单位矩阵：
                <span style="display:inline-block; vertical-align:middle;">
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">1 0 0 0</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">0 1 0 0</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">0 0 1 0</span>
                    <span style="display:block; text-align:center;">0 0 0 1</span>
                </span>
            </div>
            
            <pre>// JavaScript中4x4矩阵表示
const identityMatrix = [
    1, 0, 0, 0,
    0, 1, 0, 0,
    0, 0, 1, 0,
    0, 0, 0, 1
];</pre>
        </div>
        
        <h3>2. 矩阵运算</h3>
        <div class="benefit">
            <p>矩阵运算是3D变换的基础。</p>
            
            <h4>矩阵乘法</h4>
            <p>矩阵乘法用于组合多个变换。</p>
            
            <pre>// 矩阵乘法
function multiplyMatrices(a, b) {
    const result = new Array(16).fill(0);
    
    for (let i = 0; i < 4; i++) {
        for (let j = 0; j < 4; j++) {
            for (let k = 0; k < 4; k++) {
                result[i * 4 + j] += a[i * 4 + k] * b[k * 4 + j];
            }
        }
    }
    
    return result;
}

// 矩阵与向量相乘
function multiplyMatrixVector(matrix, vector) {
    const result = [0, 0, 0, 0];
    
    for (let i = 0; i < 4; i++) {
        for (let j = 0; j < 4; j++) {
            result[i] += matrix[i * 4 + j] * vector[j];
        }
    }
    
    return result;
}</pre>
        </div>
        
        <h3>3. 基本变换矩阵</h3>
        <div class="benefit">
            <p>3D图形学中的基本变换都可以用矩阵表示。</p>
            
            <h4>平移矩阵</h4>
            <div class="formula">
                <span style="display:inline-block; vertical-align:middle;">
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">1 0 0 tx</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">0 1 0 ty</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">0 0 1 tz</span>
                    <span style="display:block; text-align:center;">0 0 0 1</span>
                </span>
            </div>
            
            <pre>// 创建平移矩阵
function createTranslationMatrix(tx, ty, tz) {
    return [
        1, 0, 0, 0,
        0, 1, 0, 0,
        0, 0, 1, 0,
        tx, ty, tz, 1
    ];
}</pre>
            
            <h4>缩放矩阵</h4>
            <div class="formula">
                <span style="display:inline-block; vertical-align:middle;">
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">sx 0 0 0</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">0 sy 0 0</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">0 0 sz 0</span>
                    <span style="display:block; text-align:center;">0 0 0 1</span>
                </span>
            </div>
            
            <pre>// 创建缩放矩阵
function createScaleMatrix(sx, sy, sz) {
    return [
        sx, 0, 0, 0,
        0, sy, 0, 0,
        0, 0, sz, 0,
        0, 0, 0, 1
    ];
}</pre>
            
            <h4>绕Z轴旋转矩阵</h4>
            <div class="formula">
                <span style="display:inline-block; vertical-align:middle;">
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">cos(θ) -sin(θ) 0 0</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">sin(θ) cos(θ) 0 0</span>
                    <span style="border-bottom:1px solid black; display:block; text-align:center;">0 0 1 0</span>
                    <span style="display:block; text-align:center;">0 0 0 1</span>
                </span>
            </div>
            
            <pre>// 创建绕Z轴旋转矩阵
function createRotationZMatrix(angle) {
    const cos = Math.cos(angle);
    const sin = Math.sin(angle);
    
    return [
        cos, sin, 0, 0,
        -sin, cos, 0, 0,
        0, 0, 1, 0,
        0, 0, 0, 1
    ];
}</pre>
        </div>
        
        <h3>4. 齐次坐标</h3>
        <div class="benefit">
            <p>齐次坐标是一种用N+1维来表示N维坐标的方法，在3D图形学中用4维向量表示3D点。</p>
            
            <div class="formula">
                3D点 (x, y, z) 的齐次坐标表示为 (x, y, z, 1)
            </div>
            
            <p>齐次坐标的优势：</p>
            <ul>
                <li>可以用统一的矩阵表示平移、旋转、缩放等变换</li>
                <li>可以表示无穷远点（w=0）</li>
                <li>便于进行透视投影变换</li>
            </ul>
        </div>
        
        <h2>在Three.js中的应用</h2>
        
        <h3>1. Vector3类</h3>
        <div class="benefit">
            <p>Three.js提供了Vector3类来处理三维向量。</p>
            
            <pre>// Three.js中的向量操作
const vectorA = new THREE.Vector3(1, 2, 3);
const vectorB = new THREE.Vector3(4, 5, 6);

// 向量加法
const result = new THREE.Vector3();
result.addVectors(vectorA, vectorB);

// 向量长度
const length = vectorA.length();

// 单位向量
vectorA.normalize();

// 点积
const dot = vectorA.dot(vectorB);

// 叉积
const cross = new THREE.Vector3();
cross.crossVectors(vectorA, vectorB);</pre>
        </div>
        
        <h3>2. Matrix4类</h3>
        <div class="benefit">
            <p>Three.js提供了Matrix4类来处理4x4矩阵。</p>
            
            <pre>// Three.js中的矩阵操作
const matrix = new THREE.Matrix4();

// 设置为平移矩阵
matrix.makeTranslation(10, 20, 30);

// 设置为旋转矩阵
matrix.makeRotationX(Math.PI / 4);

// 设置为缩放矩阵
matrix.makeScale(2, 2, 2);

// 矩阵相乘
const otherMatrix = new THREE.Matrix4();
otherMatrix.makeTranslation(5, 0, 0);
matrix.multiply(otherMatrix);

// 应用矩阵到向量
const vector = new THREE.Vector3(1, 1, 1);
vector.applyMatrix4(matrix);</pre>
        </div>
        
        <h3>3. 欧拉角与四元数</h3>
        <div class="benefit">
            <p>Three.js使用欧拉角（Euler）和四元数（Quaternion）来表示旋转。</p>
            
            <pre>// 欧拉角（绕XYZ轴的旋转角度）
const euler = new THREE.Euler(Math.PI/2, 0, 0, 'XYZ');

// 四元数（避免万向节死锁问题）
const quaternion = new THREE.Quaternion();
quaternion.setFromEuler(euler);

// 应用旋转到物体
mesh.rotation.copy(euler);
// 或
mesh.quaternion.copy(quaternion);</pre>
        </div>
        
        <h2>实际应用示例</h2>
        
        <h3>1. 物体变换</h3>
        <div class="benefit">
            <p>在Three.js中，物体的变换由位置（position）、旋转（rotation）和缩放（scale）属性控制。</p>
            
            <pre>// 创建一个立方体并进行变换
const geometry = new THREE.BoxGeometry();
const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const cube = new THREE.Mesh(geometry, material);

// 设置位置
cube.position.set(5, 0, 0);

// 设置旋转
cube.rotation.set(Math.PI/4, Math.PI/4, 0);

// 设置缩放
cube.scale.set(2, 1, 1);

// 这些变换最终会组合成一个模型变换矩阵
scene.add(cube);</pre>
        </div>
        
        <h3>2. 相机变换</h3>
        <div class="benefit">
            <p>相机的位置和朝向也使用线性代数来表示。</p>
            
            <pre>// 创建相机
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

// 设置相机位置
camera.position.set(0, 0, 5);

// 设置相机朝向
camera.lookAt(0, 0, 0);

// 这会生成视图变换矩阵</pre>
        </div>
        
        <h3>3. 投影变换</h3>
        <div class="benefit">
            <p>投影变换将3D场景投影到2D屏幕上。</p>
            
            <pre>// 透视投影相机
const perspectiveCamera = new THREE.PerspectiveCamera(
    75,    // 视角
    window.innerWidth / window.innerHeight, // 宽高比
    0.1,   // 近裁剪面
    1000   // 远裁剪面
);

// 正交投影相机
const orthographicCamera = new THREE.OrthographicCamera(
    -10, 10,  // 左右
    10, -10,  // 上下
    0.1, 1000 // 近远裁剪面
);

// 这些会生成投影变换矩阵</pre>
        </div>
        
        <h2>学习建议</h2>
        
        <div class="quote">
            "学习线性代数不仅是为了完成开发任务，还可以帮助解决一些复杂问题，并优化代码的效率。其知识点广泛应用于游戏开发的方方面面，是从业者需要精通的重要数学工具。" - 游戏引擎学习
        </div>
        
        <ol>
            <li><strong>从基础开始</strong>：先掌握向量和矩阵的基本概念及运算</li>
            <li><strong>动手实践</strong>：通过实际编程练习加深理解</li>
            <li><strong>结合Three.js</strong>：学习Three.js提供的数学工具类</li>
            <li><strong>逐步深入</strong>：掌握基础后再学习四元数、变换组合等高级概念</li>
        </ol>
        
        <h2>总结</h2>
        
        <p>Web 3D开发需要掌握的线性代数知识主要包括：</p>
        
        <ul>
            <li><strong>向量运算</strong>：加减、标量乘法、点积、叉积、长度计算等</li>
            <li><strong>矩阵运算</strong>：矩阵乘法、基本变换矩阵（平移、旋转、缩放）</li>
            <li><strong>齐次坐标</strong>：理解齐次坐标的概念和优势</li>
            <li><strong>变换组合</strong>：理解如何通过矩阵乘法组合多个变换</li>
            <li><strong>实际应用</strong>：在Three.js中应用这些数学知识</li>
        </ul>
        
        <p>掌握这些线性代数知识将帮助你：</p>
        
        <ul>
            <li>更好地理解3D图形学原理</li>
            <li>更高效地使用Three.js等3D库</li>
            <li>解决复杂的3D变换问题</li>
            <li>优化3D应用的性能</li>
            <li>实现自定义的图形效果</li>
        </ul>
        
        <div class="challenge">
            <p>需要注意的是，虽然Three.js等库封装了大部分数学运算，但理解底层原理对于解决复杂问题和优化性能至关重要。建议在学习Three.js的同时，也要掌握这些基础的线性代数知识。</p>
        </div>
    </div>
</body>
</html>