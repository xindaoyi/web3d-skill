<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGL着色器内置变量参考文档</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        tr:hover {
            background-color: #e8f4f8;
        }
        .note {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }
        .warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 20px 0;
        }
        code {
            background-color: #eee;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>WebGL 着色器内置变量参考文档</h1>
        
        <p>WebGL 着色器内置变量（Built-in Variables）是由 OpenGL ES Shading Language (GLSL ES) 规范定义的特殊变量，它们在顶点着色器和片元着色器中自动可用，用于与图形渲染管线进行交互。</p>

        <h2>1. 顶点着色器内置变量</h2>

        <h3>1.1 输入变量（Attributes）</h3>
        <p>这些变量接收来自应用程序的顶点数据：</p>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_Vertex</code></td>
                    <td><code>attribute vec4</code></td>
                    <td>顶点位置坐标</td>
                </tr>
                <tr>
                    <td><code>gl_Normal</code></td>
                    <td><code>attribute vec3</code></td>
                    <td>顶点法向量</td>
                </tr>
                <tr>
                    <td><code>gl_Color</code></td>
                    <td><code>attribute vec4</code></td>
                    <td>顶点主颜色</td>
                </tr>
                <tr>
                    <td><code>gl_SecondaryColor</code></td>
                    <td><code>attribute vec4</code></td>
                    <td>顶点辅助颜色</td>
                </tr>
                <tr>
                    <td><code>gl_MultiTexCoord0</code></td>
                    <td><code>attribute vec4</code></td>
                    <td>纹理坐标0</td>
                </tr>
                <tr>
                    <td><code>gl_MultiTexCoord1</code></td>
                    <td><code>attribute vec4</code></td>
                    <td>纹理坐标1</td>
                </tr>
                <tr>
                    <td>...</td>
                    <td>...</td>
                    <td>纹理坐标最多支持到 <code>gl_MultiTexCoord7</code></td>
                </tr>
            </tbody>
        </table>

        <h3>1.2 输出变量（Varyings）</h3>
        <p>这些变量将数据传递给片元着色器：</p>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_FrontColor</code></td>
                    <td><code>varying vec4</code></td>
                    <td>前面顶点颜色</td>
                </tr>
                <tr>
                    <td><code>gl_BackColor</code></td>
                    <td><code>varying vec4</code></td>
                    <td>背面顶点颜色</td>
                </tr>
                <tr>
                    <td><code>gl_FrontSecondaryColor</code></td>
                    <td><code>varying vec4</code></td>
                    <td>前面辅助颜色</td>
                </tr>
                <tr>
                    <td><code>gl_BackSecondaryColor</code></td>
                    <td><code>varying vec4</code></td>
                    <td>背面辅助颜色</td>
                </tr>
                <tr>
                    <td><code>gl_TexCoord[]</code></td>
                    <td><code>varying vec4[]</code></td>
                    <td>纹理坐标数组</td>
                </tr>
                <tr>
                    <td><code>gl_FogFragCoord</code></td>
                    <td><code>varying float</code></td>
                    <td>雾化坐标</td>
                </tr>
            </tbody>
        </table>

        <h3>1.3 特殊输出变量</h3>
        <p>这些变量控制渲染管线行为，必须在顶点着色器中设置：</p>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_Position</code></td>
                    <td><code>vec4</code></td>
                    <td>顶点的裁剪坐标位置（必需）</td>
                </tr>
                <tr>
                    <td><code>gl_PointSize</code></td>
                    <td><code>float</code></td>
                    <td>点的像素大小（可选）</td>
                </tr>
            </tbody>
        </table>

        <h2>2. 片元着色器内置变量</h2>

        <h3>2.1 输入变量（Varyings）</h3>
        <p>接收从顶点着色器插值过来的数据：</p>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_Color</code></td>
                    <td><code>varying vec4</code></td>
                    <td>插值后的主颜色</td>
                </tr>
                <tr>
                    <td><code>gl_SecondaryColor</code></td>
                    <td><code>varying vec4</code></td>
                    <td>插值后的辅助颜色</td>
                </tr>
                <tr>
                    <td><code>gl_TexCoord[]</code></td>
                    <td><code>varying vec4[]</code></td>
                    <td>插值后的纹理坐标数组</td>
                </tr>
                <tr>
                    <td><code>gl_FogFragCoord</code></td>
                    <td><code>varying float</code></td>
                    <td>插值后的雾化坐标</td>
                </tr>
            </tbody>
        </table>

        <h3>2.2 特殊输入变量</h3>
        <p>提供关于当前片元的信息：</p>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_FragCoord</code></td>
                    <td><code>vec4</code></td>
                    <td>片元窗口坐标 (x, y, z, 1/w)</td>
                </tr>
                <tr>
                    <td><code>gl_FrontFacing</code></td>
                    <td><code>bool</code></td>
                    <td>片元是否属于正面(true)或背面(false)</td>
                </tr>
                <tr>
                    <td><code>gl_PointCoord</code></td>
                    <td><code>vec2</code></td>
                    <td>点精灵中的坐标(0.0到1.0)</td>
                </tr>
            </tbody>
        </table>

        <h3>2.3 特殊输出变量</h3>
        <p>定义片元的最终颜色输出：</p>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_FragColor</code></td>
                    <td><code>vec4</code></td>
                    <td>片元的颜色值（传统方式）</td>
                </tr>
                <tr>
                    <td><code>gl_FragData[]</code></td>
                    <td><code>vec4[]</code></td>
                    <td>多渲染目标输出数组</td>
                </tr>
            </tbody>
        </table>

        <h2>3. 常量内置变量</h2>
        <p>提供关于实现限制的信息，只读：</p>

        <h3>3.1 顶点着色器常量</h3>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_MaxVertexAttribs</code></td>
                    <td><code>const mediump int</code></td>
                    <td>最大属性数量</td>
                </tr>
                <tr>
                    <td><code>gl_MaxVertexUniformVectors</code></td>
                    <td><code>const mediump int</code></td>
                    <td>最大uniform向量数</td>
                </tr>
                <tr>
                    <td><code>gl_MaxVaryingVectors</code></td>
                    <td><code>const mediump int</code></td>
                    <td>最大varying向量数</td>
                </tr>
                <tr>
                    <td><code>gl_MaxVertexTextureImageUnits</code></td>
                    <td><code>const mediump int</code></td>
                    <td>顶点着色器纹理单元数</td>
                </tr>
                <tr>
                    <td><code>gl_MaxCombinedTextureImageUnits</code></td>
                    <td><code>const mediump int</code></td>
                    <td>总纹理单元数</td>
                </tr>
            </tbody>
        </table>

        <h3>3.2 片元着色器常量</h3>
        
        <table>
            <thead>
                <tr>
                    <th>变量名</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>gl_MaxTextureImageUnits</code></td>
                    <td><code>const mediump int</code></td>
                    <td>片元着色器纹理单元数</td>
                </tr>
                <tr>
                    <td><code>gl_MaxFragmentUniformVectors</code></td>
                    <td><code>const mediump int</code></td>
                    <td>片元uniform向量最大数</td>
                </tr>
                <tr>
                    <td><code>gl_MaxDrawBuffers</code></td>
                    <td><code>const mediump int</code></td>
                    <td>最大绘制缓冲区数</td>
                </tr>
            </tbody>
        </table>

        <h2>4. 使用注意事项</h2>

        <div class="note">
            <strong>必需变量：</strong>在顶点着色器中，必须写入 <code>gl_Position</code> 变量。<code>gl_PointSize</code> 仅在绘制点时需要设置。
        </div>

        <div class="note">
            <strong>精度要求：</strong>WebGL 中大多数变量需要指定精度限定符：
            <ul>
                <li><code>highp</code> - 高精度</li>
                <li><code>mediump</code> - 中等精度</li>
                <li><code>lowp</code> - 低精度</li>
            </ul>
        </div>

        <div class="note">
            <strong>现代实践：</strong>
            <ul>
                <li>现代 WebGL 程序更倾向于使用自定义的 varying 变量</li>
                <li>推荐使用 <code>gl_FragData</code> 而不是 <code>gl_FragColor</code> 以获得更好的兼容性</li>
                <li>在 WebGL 2.0 中支持更多内置变量</li>
            </ul>
        </div>

        <div class="warning">
            <strong>兼容性：</strong>某些内置变量在不同 WebGL 版本中的支持情况不同。移动设备上的 WebGL 实现可能对精度支持有限制。
        </div>

        <h2>5. 示例代码</h2>

        <h3>5.1 简单的顶点着色器示例</h3>
        <pre>
attribute vec4 a_position;
uniform mat4 u_mvpMatrix;

void main() {
    gl_Position = u_mvpMatrix * a_position;
    gl_PointSize = 10.0;
}</pre>

        <h3>5.2 简单的片元着色器示例</h3>
        <pre>
precision mediump float;

void main() {
    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0); // 红色
}</pre>

        <div class="note">
            <p>这份文档涵盖了 WebGL 着色器中所有重要的内置变量，为 WebGL 开发者提供了完整的参考。</p>
        </div>
    </div>
</body>
</html>